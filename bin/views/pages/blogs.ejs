<h1>Blogs</h1>

<div class="js-blogs-list">
    loading...
</div>

<script type="text/javascript">

    document.addEventListener("DOMContentLoaded", function () {
        const $doc = $(document),
            contactsContainer = $doc.find('.js-blogs-list');

        $.ajax({
            type: 'GET',
            url: "/api/blogs",
        })
            .done(function (data) {
                let html = `<div><table>
                    <thead>
                        <tr>
                            <th>Titulo</th>
                            <th>Data</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table></div>`;

                let tbody = '';

                data.forEach(element => {
                    let btn = getHtmlActions(element);
                    let options = {
                        day: 'numeric',
                        month: 'numeric',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit',
                    };
                    let date = new Date(Number(element.date)).toLocaleDateString('pt-br', options);

                    tbody += `
                    <tr>
                        <td>${element.name}</td>
                        <td>${!!element.date ? date : '-'}</td>
                        <td>${btn}</td>
                    </tr>`;

                });

                html = $(html).find('tbody').html(tbody).parents('div').html();
                contactsContainer.html(html);

            })
            .fail(function (err) {
                console.error(err);
            })
            .always(function () {
                contactsContainer.find('table').DataTable();
            });
    });

    function getHtmlActions(data) {
        const btn = `<a href="/secure/blogs/${data._id}">Abrir</a>`;
        return btn;
    }

</script>